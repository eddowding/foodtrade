{% extends 'tbase.html' %}
{% load staticfiles %}
{% block head %}

<link rel="stylesheet" href="/static/css/docsupport/prism.css">
<link rel="stylesheet" href="/static/css/chosen.min.css">

<style type="text/css" media="all">
    /* fix rtl for demo */
    .chosen-rtl .chosen-drop { left: -9000px; }
  </style>

{% endblock %}

{% block content %}


  <div class="row">
  
  <h3>Profile</h3>
  <form class="form-horizontal" name="myform" role="form"  method="POST" action=".">
  {% csrf_token %}
    
    <div class="form-group">
      <label for="user_fname_txt" class="col-sm-2">First Name</label>
      <div class="col-sm-10">
        <input type="text" id="user_fname_txt" class="form-control" placeholder="First name" value="{{first_name}}" name="first_name">
      </div>
    </div>

    <div class="form-group">
      <label for="user_lname_txt" class="col-sm-2">Last Name</label>
      <div class="col-sm-10">
        <input type="text" id="user_lname_txt" class="form-control" placeholder="Last name" value="{{last_name}}" name="last_name">
      </div>
    </div>

    <div class="form-group">
      <label for="user_desc_txt" class="col-sm-2">Description</label>
      <div class="col-sm-10">
        <textarea class="form-control" id="user_desc_txt" name="description" rows="5">{{description}}</textarea>
      </div>
    </div>

    <div class="form-group">
      <label for="phone" class="col-sm-2">Phone</label>
      <div class="col-sm-10">
        <input type="text" id="phone" class="form-control" placeholder="Phone number" value="{{phone}}" name="phone"  onblur="validateFeedback()" >
      </div>
    </div>

    <div class="form-group">
      <label for="zipcode" class="col-sm-2">Post / zip code</label>
      <div class="col-sm-10">
        <input type="text" id="zipcode" class="form-control" placeholder="Post / zip code" value="{{zipcode}}" name="zipcode">
      </div>
    </div>

  

    <div class="form-group"> 
 
        
        <p>
            <label for="id_sign_up_as">
                 Sign up as</label></br>
                <label class="btn btn-default">
                  {% ifequal sign_up_as 'Individual' %}
                    <input type="radio" name="sign_up_as" checked="true" id="option1" value="Individual"> Individual
                    {% else %} 
                    <input type="radio" name="sign_up_as" id="option1" value="Individual"> Individual
                  {% endifequal %}

                </label>
                <label class="btn btn-default">
                  {% ifequal sign_up_as 'Business' %}
                    <input type="radio" name="sign_up_as" checked="true" id="option2" value="Business">Business
                    {% else %} 
                    <input type="radio" name="sign_up_as"  id="option2" value="Business"> Business
                  {% endifequal %}
                </label>

                <label class="btn btn-default">
                  {% ifequal sign_up_as 'Organisation' %}
                    <input type="radio" name="sign_up_as" checked="true" id="option3" value="Organisation"> Organisation
                    {% else %} 
                    <input type="radio" name="sign_up_as" id="option3" value="Organisation"> Organisation
                  {% endifequal %}
                </label>
        </p>
        <p><input type="hidden" id= "hidden_type" name="type"></p>
        <p>
          <label for="id_type_user">Type</label><br/>
          <select id= "dropdown3" data-placeholder="Farm, wholesaler, restaurant, bakery..." multiple style="width:60%;height:25px;" class="chosen-select" tabindex="6" >
            <option value=""></option>
            {% for each in all_tags %}
            <optgroup label={{each.node}}>
              {% if each.childrens %}
                {% for eachchild in each.childrens %}
                <option>{{eachchild.node}}</option>
                {% endfor %}
              {% else %}
              <option>{{each.node}}</option>
              {% endif %}
            </optgroup>
            {% endfor %}

          </select>


        </p>
        <button type="submit" class="btn btn-primary" onclick="copydata()">Submit</button>
    </div>
  </form>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
  <script src="/static/js/chosen.jquery.min.js" type="text/javascript"></script>
  <script src="/static/css/docsupport/prism.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
  var selVals = String('{{type_user}}').split(',');
  for (var i=0; i < selVals.length; i++){
    $("select optgroup option").filter(function() {
        return $(this).text() == selVals[i];
    }).prop('selected', true);
  }
</script>
<script type="text/javascript">
function validateFeedback(){
    var phone = document.getElementById("phone");
    var RE = /^[\d\.\-]+$/;
    if(!RE.test(phone.value))
    {
        alert("You have entered an invalid phone number");
        return false;
    }
    return true;
}

  function copydata(){
    var all_values = '';
    var elements = document.getElementsByClassName('search-choice');
      for(i=0;i<elements.length;i++){
        if(all_values==''){
          all_values = all_values + elements[i].children[0].innerHTML;  
        }
        else{
        all_values = all_values + ',' + elements[i].children[0].innerHTML;
        }
      }
      document.getElementById('hidden_type').value = all_values;
    }

    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      '.chosen-select-width'     : {width:"95%"}
    }
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }
  </script>
{% endblock %}