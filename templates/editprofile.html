{% extends 'tbase.html' %}
{% load staticfiles %}
{% block head %}

<link rel="stylesheet" href="/static/css/docsupport/prism.css">
<link rel="stylesheet" href="/static/css/chosen.min.css">

<style type="text/css" media="all">
    /* fix rtl for demo */
    .chosen-rtl .chosen-drop { left: -9000px; }
    .typeempty{
  display:none;
}
  </style>

{% endblock %}

{% block content %}

<div class="col-md-10"> 
  <form class="form-horizontal" name="myform" role="form"  method="POST" action=".">
  {% csrf_token %}
    
    <div class="form-group">
      <label for="user_fname_txt" class="col-sm-2 control-label">First Name</label>
      <div class="col-sm-10">
        <input type="text" id="user_fname_txt" class="form-control" placeholder="First name" value="{{first_name}}" name="first_name">
      </div>
    </div>

    <div class="form-group">
      <label for="user_lname_txt" class="col-sm-2 control-label">Last Name</label>
      <div class="col-sm-10">
        <input type="text" id="user_lname_txt" class="form-control" placeholder="Last name" value="{{last_name}}" name="last_name">
      </div>
    </div>

    <div class="form-group">
      <label for="user_desc_txt" class="col-sm-2 control-label">Description</label>
      <div class="col-sm-10">
        <textarea class="form-control" id="user_desc_txt" name="description" rows="5">{{description}}</textarea>
      </div>
    </div>

    <div class="form-group">
      <label for="phone" class="col-sm-2 control-label">Phone</label>
      <div class="col-sm-10">
        <input type="text" id="phone" class="form-control" placeholder="Phone number" value="{{phone}}" name="phone"  onblur="validateFeedback()" >
      </div>
    </div>

    <div class="form-group">
      <label for="zip_code" class="col-sm-2 control-label">Address</label>
      <div class="col-sm-10">
        <input type="text" id="zip_code" class="form-control" placeholder="Enter your address" value="{{zip_code}}" name="zip_code">
      </div>
    </div>


    <div class="form-group">
      <label for="id_sign_up_as" class="col-sm-2 control-label">Sign up as</label>
        {{form.sign_up_as.as_hidden}}
      <div class="col-sm-10">

        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-default {% ifequal sign_up_as 'Individual' %}active{% endifequal %}"> 
              <input type="radio" name="sign_up_as" id="option1" value="Individual" onchange="dataradio('Individual')"> Individual 
          </label> 
          <label class="btn btn-default {% ifequal sign_up_as 'Business' %}active{% endifequal %}">  
              <input type="radio" name="sign_up_as"  id="option2" value="Business" onchange="dataradio('Business')"> Business 
          </label>
          <label class="btn btn-default {% ifequal sign_up_as 'Organisation' %}active{% endifequal %}">
              <input type="radio" name="sign_up_as" id="option3" value="Organisation" onchange="dataradio('Organisation')"> Organisation
          </label>
        </div>

        <input type="hidden" id= "hidden_type" name="type">

      </div>

      </div>

      
      <div class="form-group" id="type_user_id"> 
        <label for="id_type_user" class="col-sm-2 control-label">Business type</label>
        <div class="col-sm-10">
          <select id= "dropdown3" data-placeholder="Farm, wholesaler, restaurant, bakery..." multiple  class="chosen-select" tabindex="6" >
              <option value=""></option>
              {% for each in all_tags %}
              <optgroup label={{each.node}}>
                {% if each.childrens %}
                  {% for eachchild in each.childrens %}
                  <option>{{eachchild.node}}</option>
                  {% endfor %}
                {% else %}
                <option>{{each.node}}</option>
                {% endif %}
              </optgroup>
              {% endfor %}
            </select>
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-primary" onclick="copydata()">Update</button>
        </div>
      </div> 

  </form>
</div> 
<a href="/invite">invite</a>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
  <script src="/static/js/chosen.jquery.min.js" type="text/javascript"></script>
  <script src="/static/css/docsupport/prism.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
  var selVals = String('{{type_user}}').split(',');
  for (var i=0; i < selVals.length; i++){
    $("select optgroup option").filter(function() {
        return $(this).text() == selVals[i];
    }).prop('selected', true);
  }
</script>
<script type="text/javascript">
$( document ).ready(function() {
  if({{sign_up_as}}!="Business"){
    $('#type_user_id').toggleClass('typeempty');
    }
});

function dataradio(value){
    // var result_val = $("input[name=options]:checked").val();
    if (value == "Business"){
        if ( $('#type_user_id').hasClass('typeempty') ){
          $('#type_user_id').removeClass('typeempty');
        }
    }
    else{
        if ( $('#type_user_id').hasClass('typeempty') ){
          }
        else{
            $('#type_user_id').addClass('typeempty');
        }
    }
}


function validateFeedback(){
    var phone = document.getElementById("phone");
    var RE = /^[\d\.\-]+$/;
    if(!RE.test(phone.value))
    {
        alert("You have entered an invalid phone number");
        return false;
    }
    return true;
}

  function copydata(){
    var all_values = '';
    var elements = document.getElementsByClassName('search-choice');
      for(i=0;i<elements.length;i++){
        if(all_values==''){
          all_values = all_values + elements[i].children[0].innerHTML;  
        }
        else{
        all_values = all_values + ',' + elements[i].children[0].innerHTML;
        }
      }
      document.getElementById('hidden_type').value = all_values;
    }

    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      '.chosen-select-width'     : {width:"95%"}
    }
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }
  </script>
{% endblock %}