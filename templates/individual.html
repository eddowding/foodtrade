{% extends 'tbase.html' %}
{% load staticfiles %}
{% load socialaccount %}
{% load url from future %}
{% load i18n %}
{% include "socialaccount/snippets/login_extra.html" %}
{% load account %}


{% block ogtype %}{% if userprof.user_type == "Business" %}Profile{%endif%}{% if userprof.user_type == "Individual" %}business.business{%endif%}{% if userprof.user_type == "Organisation" %}business.business{%endif%}{% endblock %}
{% block titlecontent %}{{userprof.full_name}}{% endblock %}
{% block fblat %}{{userprof.lat}}{% endblock %}
{% block fblon %}{{userprof.lon}}{% endblock %}
{% block fbzipcode %}{{userprof.zip_code}}{% endblock %}
{% block fbcountry %}{{userprof.country}}{% endblock %}
{% block ogimg %}{{userprof.profileimg}}{% endblock %}
{% block contact %}
  {% if userprof.user_type == 'Business' or if userprof.user_type == 'Organisation'%}
  <meta property="business:contact_data:postal_code"    content="{{userprof.zip_code}}" /> 
  <meta property="business:contact_data:country_name"   content="{{userprof.country}}" /> 
  <meta property="business:contact_data:street_address" content="{{userprof.address}}" /> 
  <meta property="business:contact_data:locality"       content="{{userprof.address}}" /> 
  {% endif %}
{% endblock %}
{% block content %}
{% include 'modal_invite.html' %}
<style type="text/css" media="all">
    /* fix rtl for demo */
    .chosen-rtl .chosen-drop { left: -9000px; }
  </style>


    <div class="col-md-6 col-sm-7 {% if not user.is_authenticated %} col-md-offset-1 {% endif %}" id="single">
    <div class="container-responsive">
    <div id="header_box" class="clearfix individual">
      <div class="col-md-2" id="avatar">
        <img class="img-thumbnail center-block" src={{pic_url}}  />
      </div>
     
      <div class="col-md-7">
         <h1><a href="#">{{name}}</a></h1>
 
<!--           <div class="tags tags-biztype  ">  
            {% for eachtype in type_user %}
           <a href="/activity/?q={{eachtype}}">{{eachtype}}</a>
           {% endfor %}

          </div>  -->
         <hr />
         <p>{{description}}</p>        

         
         <!--  <div class="tags">  
           <a href="/tag/TAG">Box Scheme</a>
           <a href="/tag/TAG">Butcher</a>
           <a href="/tag/TAG">family</a>
           <a href="/tag/TAG">organic</a> 
          </div> -->
         <hr /> 
     
         <div class="meta small text-muted">
            
            <i class="fa fa-map-marker"></i> <a href="http://maps.google.com/maps?saddr={{loggedin_coord.lat}},{{loggedin_coord.lon}}&daddr={{loc.lat}},{{loc.lon}}" target="_blank" data-placement="top" data-toggle="tooltip" title="Get directions" class="text-muted">{{address}}</a>  
            
            <!-- if logged in or you've allows html5 browser location -->
            <i class="fa fa-location-arrow" style="margin-left: 20px;"></i> {{distance}} miles

            <!--  // if logged in or you've allows html5 browser location -->
            <!-- <i class="fa fa-bullseye" style="margin-left: 20px;"></i> 20.1 miles -->
  
         </div> <!-- meta -->
  
      </div><!-- end header middle -->
      <div id="contact_info" class="col-md-3">
      {% ifequal profile_id user_id %}
        <a href="/editprofile/{{userinfo.username}}" class="btn btn-danger btn-block">
           Edit my profile
        </a>
      {% endifequal %}
      {% ifnotequal profile_id user_id %}
      <!-- if they dont't have an account yet -->
<!--       {% if not user.is_authenticated %}
      <button class="btn btn-primary btn-block">Invite to connect</button>
     {% endif %} -->
      <!-- Button trigger modal -->
      {% if user.is_authenticated %}
          {% ifequal is_unknown_profile 'false' %}
          <button class="btn btn-primary btn-block" data-toggle="modal" data-target="#modal_contact">Contact</button>
          {% else %}
            <button class="btn btn-primary btn-block" style="margin-top:40px;" data-toggle="modal" data-target="#modal_invite">Invite to connect</button> 
          {% endifequal %}

          {% if user.is_superuser %}
            <a href="/editprofile/{{username}}/" class="btn btn-primary btn-block">Edit</a>
          {% endif %}

      {% else %}
      <!-- if not logged in show login prompt -->
      <a href="{% provider_login_url "twitter" process="login" %}" class="btn btn-primary btn-block">Login for more</a>
      {% endif %}
      {% endifnotequal %}
      <button class="btn btn-default btn-block" data-toggle="modal" data-target="#sharer">
        <i class="fa fa-share-square-o text-muted"></i> Share
      </button>
      <!--SHARER  Modal -->
      <div class="modal fade" id="sharer" tabindex="-1" role="dialog" aria-labelledby="sharer" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-body"> 
        <div class="container-responsive">
          <div class="row">
            <div class="col-sm-6">

                            <a href="#" class="btn btn-block  btn-social btn-facebook" onclick="window.open(
              'https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]='+encodeURIComponent('{{ request.build_absolute_uri }}') +'&amp;p[images][0]='+encodeURIComponent('{{pic_url}}')+'&amp;p[title]='+encodeURIComponent('{{name}} on FoodTrade')+'&amp;p[summary]='+encodeURIComponent('Hey, see my profile on FoodTrade')+'&amp;u='+encodeURIComponent('{{ request.build_absolute_uri }}') +'&amp;t='+encodeURIComponent('{{name}} on FoodTrade'),
                    'facebook-share-dialog', 
                    'width=626,height=436,top='+((screen.height - 436) / 2)+',left='+((screen.width - 626)/2 )); 
                  return false;">

                <i class="fa fa-facebook"></i>  Share on Facebook
              </a>

              <!-- <div class="fb-share-button" data-href="http://developers.facebook.com/docs/plugins/" data-type="link"></div> -->
              
              
              <a href="#" class="btn btn-block  btn-social btn-twitter" onclick="window.open(
                    'https://twitter.com/share?url='+encodeURIComponent('{{ request.build_absolute_uri }}')+'&amp;text='+encodeURIComponent('{{screen_name}} on @foodtradeHQ') + '&amp;count=none/', 
                    'twitter-share-dialog', 
                    'width=626,height=436,top='+((screen.height - 436) / 2)+',left='+((screen.width - 626)/2 )); 
                  return false;">
                <i class="fa fa-twitter"></i>  Share on Twitter
              </a>
  
              <a class="btn  btn-block  btn-social btn-pinterest" href="http://pinterest.com/pin/create/button/?url={{ request.build_absolute_uri|urlencode }}&media={{pic_url|urlencode}}&description={{screen_name|urlencode}}{{' on FoodTrade'|urlencode}}" class="pin-it-button" count-layout="horizontal">
                <i class="fa fa-pinterest"></i>
                Share on Pinterest
              </a>
            </div>
            <div class="col-sm-6">
              <a  class="btn btn-social btn-block btn-google-plus" href="https://plus.google.com/share?url={{ request.build_absolute_uri|urlencode }}">
                <i class="fa fa-google-plus"></i>
                Share on Google+
              </a>
              <a  class="btn btn-block btn-social btn-tumblr" href="http://www.tumblr.com/share" title="Share on Tumblr">
                <i class="fa fa-tumblr"></i>
                Share on Tumblr
              </a>
                 
              <a  class="btn btn-block  btn-social btn-bitbucket" href="http://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri|urlencode}}&title={{screen_name}} on FOodTrade&summary=Hey, view my profile on Foodtrade.&source=">
                <i class="fa fa-linkedin"></i>
                Share on LinkedIn
              </a>
            </div>
            </div>
            </div>
              <script type="text/javascript" src="http://platform.tumblr.com/v1/share.js"></script>
            </div> 
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->
      <!-- <div class="icons text-center" style="font-size:25px">
        <a href="#"><i class="fa fa-facebook-square"></i></a>
        <a href="#"><i class="fa fa-twitter-square"></i></a> 
        <a href="#"><i class="fa fa-phone-square"></i></a> 
        <a href="#"><i class="fa fa-rss-square"></i></a> 
        <a href="#"><i class="fa fa-envelope"></i></a> 
        <a href="#"><i class="fa fa-globe"></i></a> 
        <a href="#"><i class="fa fa-youtube"></i></a> 
        <a href="#"><i class="fa fa-linkedin-square"></i></a> 
      </div>  -->
      
     <!-- modal_contact -->
      <div class="modal fade" id="modal_contact" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title" id="myModalLabel">Contact {{userinfo.name}}</h4>
            </div>
            <div class="modal-body">
            <div class="container-responsive">
              <div class="row">
                <div class="col-sm-4">
             
                  <address> 

          <a href="mailto:{{email}}" class="dotdotdot" target="_blank"><i class="fa fa-envelope text-muted fa-fw"></i> {{email}} </a><br />
          <a href="http://twitter.com/{{screen_name}}"  target="_blank"><i class="fa fa-twitter text-muted fa-fw"></i> {{screen_name}}</a><br /> 
         
         
                  </address>
                </div>
                
                <div class="col-sm-8 contact-form">
                  <form id="contact" method="post" class="form" role="form">
                    <div class="row">
                      <div class="col-xs-6 col-md-6 form-group">
                        <input class="form-control" id="sender_name" name="name" placeholder="Name" type="text" required autofocus value = "{{userinfo.full_name}}"/>
                      </div>
                      <div class="col-xs-6 col-md-6 form-group">
                        <input class="form-control" id="sender_email" name="email" placeholder="Email" type="email" required value = "{{userinfo.email}}" />
                      </div>
                    </div> 
                    <textarea class="form-control" id="email_message" placeholder="Type in your message" rows="5"></textarea>
                    <h6 class="pull-right" id="contact_counter">120 characters remaining</h6>
                     
                  </form>
                </div>
              </div>
            </div>
 
   
            </div>
            <div class="modal-footer">  
              <button type="button" id="contact_tweet" class="btn btn-info" onclick="post_contact_tweet('{{screen_name}}')"><i class="fa fa-fw fa-twitter"></i> Tweet it</button>
              <button type="button" class="btn btn-success" onclick="send_email('{{email}}')"><i class="fa fa-envelope fa-fw"></i> Email it</button>
            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->
      <!-- modal_customer -->
      
 
      </div><!-- end header last -->
    </div>
    </div>
<div class="row">
     <div class="col-md-12">
        <ul class="nav nav-tabs ">
          <li class="active"><a href="#activity" data-toggle="tab">Updates <span class="badge ">{{updates_count}}</span></a></li>
        </ul>
     </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="container-responsive clearfix">

        <div class="tab-content">
<div class="tab-pane active fade in" id="activity">

          <div class="container-responsive">
          <div class="row">
              <div class="col-md-12">
            {% if user.is_authenticated %}
                  <div>

                      <!-- if this is the profile of the logged in user -->
                      <!-- <div class="well well-sm">
                          <div class="input-group">
                              <input id="btn-input" type="text" class="form-control input-sm" placeholder="Send an update..." />
                              <span class="input-group-btn">
                                  <button class="btn btn-warning btn-sm" id="btn-chat">
                                      Send</button>
                              </span>
                          </div>
                      </div> -->
                      <!-- // if this is the profile of the logged in user -->
                      <div>
                          <ul class="chat">
                          {% for eachUpdate in updates %}
                              <li class="left clearfix"><span class="chat-img pull-left">
                                  <img src="{{userprof.profileimg}}" />
                              </span>
                                  <div class="chat-body clearfix">
                                      <div class="header">                                                                                                                                                                                                                                                                                                                                                        
                                          <strong class="primary-font">{{eachUpdate.user.name}}</strong> 
                                          <small class="pull-right text-muted">
                                          <a href="/{{username}}/post/{{eachUpdate.tweetuid}}/"><span class="glyphicon glyphicon-time"></span>{{eachUpdate.time_elapsed}} ago</a></small>
                                      </div>
                                      <p>
                                         {{eachUpdate.status}}
                                      </p>
                                  </div>
                              </li>
                          {% endfor %}    
                          </ul>
                      </div>
                  </div>
              {% else %}
                <p class="alert alert-warning"><a href="{% provider_login_url "twitter" process="login" %}" class="">Login</a> or <a href="{% provider_login_url "twitter" process="login" %}" class="">sign up free</a> to see updates and activity. </p>
              {% endif %}

              </div>

          </div>

          </div>
        </div>
</div></div></div></div>


</div>
<div class="col-md-4 col-sm-3">
    <div style="width:100%; z-index: 100;" id="map">
      <div class="alert alert-warning">
          <p>This map shows 
          Customers as points
          Stockist as organge lines and 
          Supplieras as purple lines</p>
          <p>There are radius lines at 15, 30, and 100 miles.</p>
        </div>
           </div> 
           </div>


 {% endblock %}
    {% block footer %}
     <script src="{% static "js/contact.js" %}"></script>
    <script type="text/javascript">
    tweetlistener('email_message', 'contact_counter', 'contact_tweet');
    map_lat={{ loc.lat }};
    map_lon = {{ loc.lon }};
    var name = "{{userprof.full_name}}";
      var description = "{{userprof.description}}";
      var photo =  "{{userprof.profileimg}}";
      var username = "{{userprof.username}}";
      var type = "{{userprof.type}}".split(',');
      var latitude =  {{userprof.lat}};
          var longitude =  {{userprof.lon}};
    </script>
          <script src="{% static "js/individual-map.js" %}"></script>
          
{% endblock %}